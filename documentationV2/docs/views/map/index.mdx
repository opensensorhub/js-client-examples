---
id: index
title: General
sidebar_label: General
---

The map views are a way of showing data point on a map. Often, it is used to show GPS data, or fixed position of any sensor.
This View can also display path using the corresponding [Styler](../stylers/styler).

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

import { useEffect } from 'react';
import SweJson from 'osh/datareceiver/SweJson.js';
import PointMarker from 'osh/ui/styler/PointMarker.js';
import LeafletView from 'osh/ui/view/map/LeafletView.js';
import OpenLayerView from 'osh/ui/view/map/OpenLayerView.js';
import TileLayer from 'ol/layer/Tile';
import XYZ from 'ol/source/XYZ';
import CesiumView from 'osh/ui/view/map/CesiumView.js';
import {
	EllipsoidTerrainProvider
} from 'cesium';

export const LeafletMapView = () => {
 // Similar to componentDidMount and componentDidUpdate:
  useEffect(() => {
        const cfg = {
            protocol: "ws",
            service: "SOS",
            endpointUrl: "sensiasoft.net:8181/sensorhub/sos",
            offeringID: "urn:android:device:060693280a28e015-sos",
            observedProperty: "http://sensorml.com/ont/swe/property/Location",
            startTime: "2015-02-16T07:58:32Z",
            endTime: "2015-02-16T08:09:00Z",
            replaySpeed: 2
        };
        const dataSource = new SweJson("android-GPS", cfg);
        const pointMarker = new PointMarker({
            locationFunc: {
                dataSourceIds: [dataSource.getId()],
                handler: function(rec) {
                    return {
                        x: rec.location.lon,
                        y: rec.location.lat
                    };
                }
            },
            orientation: {
                heading: 0
            },
          	icon: '/img/car-location.png',
            iconAnchor: [16, 64],
            iconSize: [32, 64],
            zoomLevel: 17
        });
        const layer = L.tileLayer('https://tiles.stadiamaps.com/tiles/outdoors/{z}/{x}/{y}{r}.png', {
              maxZoom: 20,
              attribution: '&copy; <a href="https://stadiamaps.com/">Stadia Maps</a>, ' +
                  '&copy; <a href="https://openmaptiles.org/">OpenMapTiles</a> ' +
                  '&copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'
            });
        const baseLayers = {
                  "OSM Bright" : layer
        };
        const view = new LeafletView("leaflet-map",
            [{
                styler: pointMarker,
                name: "Android Phone GPS"
            }], {
              		autoZoomOnFirstMarker: true,
              		follow: true,
              		baseLayers: baseLayers,
                    defaultLayer: layer
              	}
        );
        dataSource.connect();
        return () => {
            dataSource.terminate();
            view.destroy();
        }
    });
    return <div style={{height:500 +'px'}} id="leaflet-map"></div>;
}


export const OpenLayerMapView = () => {
 // Similar to componentDidMount and componentDidUpdate:
  useEffect(() => {
        const cfg = {
            protocol: "ws",
            service: "SOS",
            endpointUrl: "sensiasoft.net:8181/sensorhub/sos",
            offeringID: "urn:android:device:060693280a28e015-sos",
            observedProperty: "http://sensorml.com/ont/swe/property/Location",
            startTime: "2015-02-16T07:58:32Z",
            endTime: "2015-02-16T08:09:00Z",
            replaySpeed: 2
        };
        const dataSource = new SweJson("android-GPS", cfg);
        const pointMarker = new PointMarker({
            locationFunc: {
                dataSourceIds: [dataSource.getId()],
                handler: function(rec) {
                    return {
                        x: rec.location.lon,
                        y: rec.location.lat
                    };
                }
            },
            orientation: {
                heading: 0
            },
          	icon: '/img/car-location.png',
            iconAnchor: [16, 64],
            iconSize: [32, 64],
            zoomLevel: 17
        });
        const baseLayer = new TileLayer({
           source: new XYZ({
             url: 'https://tiles.stadiamaps.com/tiles/outdoors/{z}/{x}/{y}.png',
             tilePixelRatio: 2
           }),
           title: 'Stadia',
           visible: true
        });
        const overlay = new TileLayer({
           source: new XYZ({
             url: 'http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}.png',
             tilePixelRatio: 2
           }),
           title: 'Esri Sat',
           visible: false
        });
        const view = new OpenLayerView("ol-map",
            [{
                styler: pointMarker,
                name: "Android Phone GPS"
            }], {
              		autoZoomOnFirstMarker: true,
              		watch: true,
              		baseLayers: [baseLayer],
                    overlayLayers: [overlay]
              	}
        );
        dataSource.connect();
        return () => {
            dataSource.terminate();
            view.destroy();
        }
    });
    return <div style={{height:500 +'px'}} id="ol-map"></div>;
}

export const CesiumMapView = () => {
 // Similar to componentDidMount and componentDidUpdate:
  useEffect(() => {
        window.CESIUM_BASE_URL = '../../../';
        const cfg = {
            protocol: "ws",
            service: "SOS",
            endpointUrl: "sensiasoft.net:8181/sensorhub/sos",
            offeringID: "urn:android:device:060693280a28e015-sos",
            observedProperty: "http://sensorml.com/ont/swe/property/Location",
            startTime: "2015-02-16T07:58:32Z",
            endTime: "2015-02-16T08:09:00Z",
            replaySpeed: 2
        };
        const dataSource = new SweJson("android-GPS", cfg);
        const pointMarker = new PointMarker({
            locationFunc: {
                dataSourceIds: [dataSource.getId()],
                handler: function(rec) {
                    return {
                        x: rec.location.lon,
                        y: rec.location.lat
                    };
                }
            },
            orientation: {
                heading: 0
            },
          	icon: '/img/car-location.png',
            iconAnchor: [16, 64],
            iconSize: [32, 64],
            zoomLevel: 17
        });
        const view = new CesiumView('cesium-map',
        	[{
        		styler: pointMarker,
        		name: 'Android Phone GPS'
        	}]
        );
        view.viewer.terrainProvider = new EllipsoidTerrainProvider();
        dataSource.connect();
        return () => {
            dataSource.terminate();
            view.destroy();
        }
    });
    return <div style={{height:500 +'px'}} id="cesium-map"></div>;
}

<Tabs
  groupId="map-viewers"
  defaultValue="Leaflet"
  values={[
    {label: 'Leaflet', value: 'Leaflet'},
    {label: 'OpenLayers', value: 'OpenLayers'},
    {label: 'Cesium', value: 'Cesium'},
  ]}>
  <TabItem value="Leaflet">
    <LeafletMapView/>
  </TabItem>
  <TabItem value="OpenLayers">
    <OpenLayerMapView/>
  </TabItem>
  <TabItem value="Cesium">
    <CesiumMapView/>
  </TabItem>
</Tabs>

## Example

The code is pretty similar between each view. Depending on what we want to display, we can have the same code or add
options specific to a View, for example, the ImageDraping to the Cesium one.

Here is an example of common and specific code for the View:

```jsx title="common code"
import SweJson from 'osh/datareceiver/SweJson.js';
import PointMarker from 'osh/ui/styler/PointMarker.js';

const cfg = {
    protocol: "ws",
    service: "SOS",
    endpointUrl: "sensiasoft.net:8181/sensorhub/sos",
    offeringID: "urn:android:device:060693280a28e015-sos",
    observedProperty: "http://sensorml.com/ont/swe/property/Location",
    startTime: "2015-02-16T07:58:32Z",
    endTime: "2015-02-16T08:09:00Z",
    replaySpeed: 2
};

const dataSource = new SweJson("android-GPS", cfg);

const pointMarker = new PointMarker({
    locationFunc: {
        dataSourceIds: [dataSource.getId()],
        handler: function(rec) {
            return {
                x: rec.location.lon,
                y: rec.location.lat
            };
        }
    },
    orientation: {
        heading: 0
    },
    icon: '/img/car-location.png',
    iconAnchor: [16, 64],
    iconSize: [32, 64],
    zoomLevel: 17
});
```

<Tabs
  groupId="map-viewers"
  defaultValue="Leaflet"
  values={[
    {label: 'Leaflet', value: 'Leaflet'},
    {label: 'OpenLayers', value: 'OpenLayers'},
    {label: 'Cesium', value: 'Cesium'},
  ]}>
  <TabItem value="Leaflet">

  ```jsx title="Leaflet specific code"
  import LeafletView from 'osh/ui/view/map/LeafletView.js';

  const view = new LeafletView("leaflet-map",
      [{
          styler: pointMarker,
          name: "Android Phone GPS"
      }],
      {
        autoZoomOnFirstMarker: true,
        follow: true
     }
  );

  dataSource.connect();
  ```

  </TabItem>
  <TabItem value="OpenLayers">

  ```jsx title="OpenLayers specific code"
  import OpenLayerView from 'osh/ui/view/map/OpenLayerView.js';

  const view = new OpenLayerView("leaflet-map",
      [{
          styler: pointMarker,
          name: "Android Phone GPS"
      }],
      {
        autoZoomOnFirstMarker: true,
        watch: true
     }
  );

  dataSource.connect();
  ```

  </TabItem>
  <TabItem value="Cesium">

  ```jsx title="Cesium specific code"
  import OpenLayerView from 'osh/ui/view/map/OpenLayerView.js';
  window.CESIUM_BASE_URL = './';

  const view = new CesiumView('cesium-map',
    [{
        styler: pointMarker,
        name: 'Android Phone GPS'
  }]);
  view.viewer.terrainProvider = new EllipsoidTerrainProvider();
  dataSource.connect();
  ```

  </TabItem>
</Tabs>

## View items

The Map views are composed by view items. ViewItems allow you to associate a name and a Styler to each marker you want
 to add to the View. Thus, to visualize your data in your view, the process is:

 [Styler](../../stylers/styler)-> ViewItem -> View

The properties of a ViewItem are:

| Name | Type | Default | Description |  Mandatory
| ---- | ---- | ------- | --------------- |  ---------
| name | String | '' | name of the viewItem | -
| styler | [Styler](../../stylers/styler) | - | styler composing the ViewItem | yes
